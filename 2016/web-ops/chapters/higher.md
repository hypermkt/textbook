# さらなる高みへ

基本的な冗長化が完了したので、これ以降は応答性の改善や、さらに障害に強い構成を目指して改良していきましょう。以下にいくつかお題を示すので、チームで選んで挑戦してください。

## 静的ファイルの配信元の変更

現在の構成では、jsやcssへのリクエストもRailsアプリが受け`public`ディレクトリにあるものを返していますが、これらは静的ファイルなので、内容が動的に変わることはありません。つまりRailsアプリではなく、その1段前のリバースプロキシが返したほうがレスポンスも速くなり、アプリケーションサーバの負荷軽減にも繋がると考えられます。[Cloudflare](https://www.cloudflare.com/features-cdn)など、無料で使えるCDNを試してみるのもよいでしょう。

## リバースプロキシの冗長化

ある一点の故障でシステム全体が機能しなくなるようなシステム上の点をSPOF（Single Point of Failure, 単一障害点）と呼びます。現在の構成ではユーザがからのリクエストが最初に到達するリバースプロキシが単一障害点と言えますので、これを冗長化します。キーワードとしては、keepalivedやVRRPといった言葉を調べてみるとよいでしょう。

## Auto Scale

現在の構成では、アプリケーションサーバは2台で固定になっていると思います。サービスが成長してユーザが増えれば3台目、4台目とスケールアウトする必要が出てくるでしょう。TV放送などメディアへの露出によって急激に負荷が増大することもあります。さらに言えば、サーバを増やすだけでなく、負荷が減る夜間は台数を減らしたり、インスタンスサイズを変えたりといった方法もコスト削減の方法として有効です。
自動で、またはコマンド数回でスケールアウト・スケールアップが行えるようにするには、どのような方法があるか考えてみてください。部分的にでも実現の見通しが立てば挑戦してみてください。

ここに挙げた以外にも、自分たちで改善案を考えてみるのもよいでしょう。改善が数値で計測できそうなら、ベンチマークを取ってみてください。参考に、Webオペレーション研修のイントロダクションで話をした図を以下に示します。

<img src="../assets/big_picture.png" width="500" alt="より高可用な構成">
